# ==========================================
# CONFIGURAÇÃO GERAL DO RUFF
# ==========================================
[tool.ruff]
# O tamanho da linha vale tanto para o linter quanto para o formatador
line-length = 88
target-version = "py312"
exclude = [
    ".git",
    "__pycache__",
    "migrations",
    "static",
    "media",
    "venv",
    ".venv",
    "node_modules",
]

# ==========================================
# CONFIGURAÇÃO DO LINTER (Regras de Lógica)
# ==========================================
[tool.ruff.lint]
# Apenas aponta erros, NÃO corrige automaticamente sem o comando --fix
select = ["E", "F", "W", "I", "B", "RUF", "UP", "DJ"]
ignore = ["E203"]

# Ignora erros específicos em arquivos específicos
[tool.ruff.lint.per-file-ignores]
"__init__.py" = ["F401", "F403"]
"settings.py" = ["F401", "F403"]

# ==========================================
# CONFIGURAÇÃO DO FORMATTER (Estilo Visual)
# ==========================================
[tool.ruff.format]
# Garante que o formatador use aspas duplas (padrão Python moderno)
quote-style = "double"
# Usa espaços em vez de tabulação
indent-style = "space"
# Respeita vírgulas no final de listas (trailing commas)
skip-magic-trailing-comma = false
# Termina arquivos com uma linha em branco
line-ending = "auto"

# ==========================================
# CONFIGURAÇÃO DO PYTEST
# ==========================================
[tool.pytest.ini_options]
DJANGO_SETTINGS_MODULE = "wedding_management.settings.test"
python_files = [
    "test.py", "tests.py", "test_*.py", "tests_*.py", "*_test.py", "*_tests.py"
]
addopts = """
    --doctest-modules
    --strict-markers
    -rP
    --ds=wedding_management.settings.test
    -n auto
    --ignore=wedding_management/settings/production.py
    --ignore=wedding_management/urls.py
"""
log_cli = false
log_level = "ERROR"
markers = [
    "unit: Testes unitários",
    "integration: Testes de integração",
    "functional: Testes funcionais",
]

# ==========================================
# CONFIGURAÇÃO DO COVERAGE
# ==========================================
[tool.coverage.run]
relative_files = true
branch = true
source = ["."]
omit = [
    "*/migrations/*",
    "*/tests/*",
    "manage.py",
    "*/settings/*",
    "*/wsgi.py",
    "*/asgi.py",
    "*/apps.py",
    "*/celery.py",
    "*/__init__.py",
]

[tool.coverage.report]
exclude_lines = [
    "pragma: no cover",
    "def __str__",
    "def __repr__",
    "if settings.DEBUG",
    "raise NotImplementedError",
]
