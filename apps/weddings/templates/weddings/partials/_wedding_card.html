{% with w=item.wedding %}

<div class="col-md-4 mb-4" id="wedding-card-{{ w.id }}">
    <div class="card-wrapper" data-href="{% url 'weddings:wedding_detail' w.id %}">
    <div class="card shadow-lg rounded-4 border-0 position-relative">

        <div class="top-banner" style="background: {{ item.gradient }};">
        <div class="circle">
            {% if w.groom_name and w.bride_name %}
            {{ w.groom_name|slice:":1" }}&{{ w.bride_name|slice:":1" }}
            {% elif item.client %}
            {{ item.client.name|slice:":1" }}
            {% else %}
            --
            {% endif %}
        </div>
        <div class="top-icon-document">
            <i class="fas fa-file-lines"></i>
        </div>
        </div>

        <div class="card-body position-relative">

        <div class="d-flex justify-content-between align-items-center mb-1">
            <h5 class="fw-bold text-dark mb-0">
            {% if w.groom_name and w.bride_name %}
                {{ w.groom_name }} & {{ w.bride_name }}
            {% elif item.client %}
                {{ item.client.name }}
            {% else %}
                Casamento sem nome
            {% endif %}
            </h5>
            <div class="d-flex gap-2">
                <a href="#" 
                class="btn-edit"
                hx-get={% url 'weddings:edit_wedding' w.id %} 
                hx-target="#modal-container"
                data-bs-toggle="modal"
                data-bs-target="#main-modal">
                    <i class="fas fa-pencil-alt"></i>
                </a>
                
                <form method="POST" action="{% url 'weddings:delete_wedding' w.id %}" onsubmit="return confirm('Deseja excluir este casamento?')">
                    {% csrf_token %}
                    <button type="submit" class="btn-delete" title="Excluir">
                    <i class="fas fa-trash-alt"></i>
                    </button>
                </form>
            </div>
        </div>

        <p class="mb-1 text-muted"><i class="fas fa-calendar-days"></i> {{ w.date|date:"d \d\e F, Y" }}</p>
        <p class="mb-3 text-muted"><i class="fas fa-location-dot"></i> {{ w.location }}</p>

        <div class="d-flex justify-content-between align-items-center mb-2">
            <span class="text-muted small">Progresso</span>
            <span class="small text-muted">65%</span>
        </div>
        <div class="progress mb-3">
            <div class="progress-bar" role="progressbar" style="width: 65%; background: {{ item.gradient }};" aria-valuenow="65" aria-valuemin="0" aria-valuemax="100"></div>
        </div>

        <div class="d-flex justify-content-between text-center info-stats">
            <div><strong>{{ item.items_count }}</strong><br><small>Itens</small></div>
            <div><strong>{{ item.contracts_count }}</strong><br><small>Contratos</small></div>
        </div>
        </div>

    </div>
    </div>
</div>
{% endwith %}