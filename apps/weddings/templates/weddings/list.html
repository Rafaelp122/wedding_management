{% extends 'base-apps.html' %}
{% load static %}
{% block page_title %} Meus Casamentos {% endblock %}

{% block page_styles %}
  <link rel="stylesheet" href="{% static 'weddings/css/list.css' %}">
{% endblock page_styles %}

{% block content %}
<div class="container py-3">
  
  <div class="d-flex justify-content-between align-items-center mb-3">
    <div>
      <h2 class="display-6 fw-bold text-dark">Meus Casamentos</h2>
      <p class="text-muted fs-5">Gerencie todos os detalhes dos seus eventos</p>
    </div>

    <button class="btn btn-primary"
          hx-get="{% url 'weddings:create_wedding' %}"  
          hx-target="#modal-container"
          data-bs-toggle="modal"
          data-bs-target="#main-modal">
      <i class="fas fa-plus me-1"></i> Novo Casamento
    </button>
  </div>

  {% comment %} Renderiza a lista de casamentos {% endcomment %}
  <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4 mb-5" id="wedding-list-container">
    {% include "weddings/partials/_wedding_list_content.html" %}
  </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
  document.body.addEventListener('click', function(e) {
    
    // Procura pelo 'card-wrapper' clicável
    const cardWrapper = e.target.closest('.card-wrapper');

    // Ignora se não for um card-wrapper ou se o clique foi num link, botão ou form
    if (!cardWrapper || e.target.closest('a') || e.target.closest('button') || e.target.closest('form')) {
      return;
    }

    // Redireciona para a página de detalhes
    const link = cardWrapper.getAttribute('data-href');
    if (link) {
      window.location.href = link;
    }
  });
</script>
{% endblock %}
