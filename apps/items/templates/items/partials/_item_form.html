<div id="items-wrapper" class="bg-white p-4 rounded-4 aba-bloco custom-shadow-lg">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h5 class="fw-bold text-dark mb-0">
            {% if form.instance.pk %}
                Editar Item: {{ form.instance.name }}
            {% else %}
                Adicionar Novo Item
            {% endif %}
        </h5>
    </div>

    {% comment %} O hx-post aponta dinamicamente para a view correta {% endcomment %}
    <form hx-post="{% if form.instance.pk %}{% url 'items:edit_item' form.instance.pk %}{% else %}{% url 'items:add_item' wedding.id %}{% endif %}"
          hx-target="#items-wrapper"
          hx-swap="outerHTML">
        
        {% csrf_token %}
        {% include "partials/_form_fields.html" %}

        <hr class="my-4">

        <div class="d-flex justify-content-end gap-2">
            {% comment %} 
              Botão Cancelar.
              Ele SEMPRE recarrega a lista de itens.
              'wedding.id' está disponível em ambas as views (Add e Edit).
            {% endcomment %}
            <button type="button" 
                    class="btn btn-outline-secondary"
                    hx-get="{% url 'items:partial_items' wedding.id %}"
                    hx-target="#items-wrapper"
                    hx-swap="outerHTML">
                Cancelar
            </button>

            <button type="submit" class="btn btn-primary">
                {% if form.instance.pk %}
                    Salvar Alterações
                {% else %}
                    Salvar Item
                {% endif %}
            </button>
        </div>
    </form>
</div>
